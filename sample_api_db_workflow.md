# User Data Sync

API integration with Trino database for user data synchronization

## Overview

This workflow integrates with REST APIs and Trino databases to process and synchronize data. It was generated using the Valiant API + Database template.

## Configuration

### API Settings
- **Base URL**: `https://api.example.com`
- **Authentication**: api_key
- **Endpoints**: `GET /users`, `POST /users`

### Database Settings
- **Host**: `localhost:8080`
- **Catalog**: `hive`
- **Schema**: `default`
- **Target Table**: `users`

## Operations

This workflow performs the following operations:
- Fetch Api Data
- Validate Data
- Insert To Db

## Usage

### CLI Execution
```bash
python run.py run user_data_sync \
  --set batch_size=1000 \
  --set api_key="your_api_key"
```

### API Execution
```bash
curl -X POST http://localhost:8000/run/user_data_sync \
  -H "Content-Type: application/json" \
  -d '{
    "batch_size": 1000,
    "api_key": "your_api_key"
  }'
```

## Input Fields

- **batch_size**: Number of records to process per batch (1-10000, default: 1000)
- **api_key**: API key for authentication (required)

## Steps

1. **Fetch API Data**: Retrieves data from the REST API endpoint
2. **Validate Data**: Performs data quality checks and validation
3. **Insert to Database**: Inserts processed data into Trino

## Error Handling

This workflow includes the following error handling strategies:
- Retry Failed Requests
- Log Errors To Db

## Metrics and Tags

This workflow emits the following metrics:
- `api_records_fetched`: Number of records retrieved from API
- `api_response_time`: API response time in seconds
- `valid_records`: Number of records that passed validation
- `validation_errors`: Number of validation errors
- `records_inserted`: Number of records inserted into database
- `batch_size_used`: Batch size used for database operations

Tags used:
- `api`, `database`, `integration`, `trino`
- Step-specific tags: `fetch`, `validation`, `transformation`, `insert`, `sync`

## Dependencies

- `requests`: For HTTP API calls
- `trino`: For Trino database connectivity
- `pandas`: For data validation and transformation

## Generated Files

- `user_data_sync.py`: Main workflow implementation
- `test_user_data_sync.py`: Unit tests
- `user_data_sync.md`: This documentation

---

*Generated by Valiant Workflow Template Engine*